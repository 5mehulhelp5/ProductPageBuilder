<?php
/**
 * Cytracon
 *
 * This source file is subject to the Cytracon Software License, which is available at https://www.cytracon.com/license
 * Do not edit or add to this file if you wish to upgrade the to newer versions in the future.
 * If you wish to customize this module for your needs.
 * Please refer to https://www.cytracon.com for more information.
 *
 * @category  Cytracon
 * @package   Cytracon_ProductPageBuilder
 * @copyright Copyright (C) 2019 Cytracon (https://www.cytracon.com)
 */

// @codingStandardsIgnoreFile
/**
 * @var $block \Cytracon\ProductPageBuilder\Block\Product\Element
 */

$product = $this->getProduct();
?>
<div class="ppbd-product-addtocart">
	<?php if ($product->getTypeId() == \Magento\Bundle\Model\Product\Type::TYPE_CODE) { ?>
		<?= $block->renderElement('customize.button') ?>
	<?php } else { ?>
		<?= $block->renderElement('product.info') ?>
	<?php } ?>
</div>
<script>
	require(['jquery'], function($) {
		var addToCartParents = $('.mgz-element-product_addtocart').parents('.mgz-element-inner');
		var priceParents     = $('.mgz-element-product_price').parents('.mgz-element-inner');
		var parent;
		for (var i = 0; i < addToCartParents.length; i++) {
			if ($.inArray(addToCartParents[i], priceParents) !== -1 && !parent) {
				parent = $(addToCartParents[i]);
			}
		}
		if (parent && !$('.cytracon-builder .product-info-main').length) parent.addClass('product-info-main');
	});
</script>